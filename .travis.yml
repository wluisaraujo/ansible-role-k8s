---
language: python

sudo: true

services:
 - docker

 env:
  global:
    - ROLE_NAME: iac-ansible-k8s
    - ANSIBLE_ACTION_WARNINGS: "False"
    - ANSIBLE_COMMAND_WARNINGS: "False"
    - ANSIBLE_DEPRECATION_WARNINGS: "False"
    - ANSIBLE_SYSTEM_WARNINGS: "False"
    - ANSIBLE_HOST_KEY_CHECKING: "False"
     
- distribution: centos
  version: 7

addons:
 yum:
 packages:
 - python2-pip.noarch
 - python3*-pip.noarch

install:
 # Install ansible
 - pip install ansible

# Check ansible version
 - ansible --version

# Create ansible.cfg with correct roles_path
 - printf '[defaults]\nroles_path=../' >ansible.cfg


 # Install ansible role
 - ansible-galaxy install wluisaraujo.iac_ansible_k8s

script:
 # Basic role syntax check
 - ansible-playbook tests/test.yml -i tests/inventory --syntax-check
 - ansible-playbook -i tests/inventory tests/test.yml --connection=local --check

notifications:
 webhooks: https://galaxy.ansible.com/api/v1/notifications/
...